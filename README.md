# Semi-supervised-lung-segmentation
Shape-Aware synthesis of pathological lung CT scans using CycleGAN for enhanced semi-supervised lung segmentation


This is the official implementation of the submitted paper to SPIE 2025 

Abstract : 
This paper addresses the problem of pathological lung segmentation, a significant challenge in medical image analysis, particularly pronounced in cases of peripheral opacities (severe fibrosis and condensations) because of the textural similarity between lung tissue and surrounding areas.
To overcome these challenges, this paper emphasizes the use of CycleGAN for unpaired image-to-image translation, in order to provide an augmentation method able to generate fake pathological images matching an existing ground truth. Although previous studies have employed CycleGAN, they often neglect the challenge of shape deformation, which is crucial for accurate medical image segmentation. Our work introduces an innovative strategy that incorporates additional loss functions. Specifically, it proposes an L1 loss based on the lung surrounding which shape is constrained to remain unchanged at the transition from the healthy to pathological domains. The lung surrounding is derived based on ground truth lung masks available in the healthy domain. Furthermore, preprocessing steps, such as cropping based on ribs/vertebra locations, are applied to refine the input for the CycleGAN, ensuring that the network focus on the lung region. This is essential to avoid extraneous biases, such as the zoom effect bias, which can divert attention from the main task.
The method is applied to enhance in semi-supervised manner the lung segmentation process by employing a U-Net model trained with on-the-fly data augmentation incorporating synthetic pathological tissues generated by the CycleGAN model. The combined use of CycleGAN for data augmentation and U-Net for segmentation leads to a very effective and reliable method for image segmentation requiring a reduced amount of native data for training.
Preliminary results from this research demonstrate significant qualitative and quantitative improvements, setting a new benchmark in the field of pathological lung segmentation.

To use the model follow the instructions in the notebook
For local usage here is the drive link for the weights of the model : https://drive.google.com/file/d/1RKCohZhh5MUPG60Bga6qc33iOH1TEXbm/view?usp=sharing

Copyright Notice

All rights reserved. The model described herein is the proprietary intellectual property of the authors and is developed for the exclusive purpose of submission to [MIDL 2024]. The use of this model, including but not limited to its replication, modification, integration, or inclusion in any other paper, manuscript, or publication, is strictly prohibited until the original paper has been officially published and is publicly accessible.

Notwithstanding the above, reviewers assigned by [MIDL 2024] are granted temporary permission to use this model solely for the purpose of evaluating the submitted paper. Reviewers are obligated to maintain confidentiality and to avoid any form of unauthorized use, sharing, or distribution of the model or its components.

Any unauthorized use, sharing, or distribution of this model, or any part thereof, outside the scope of the intended paper submission or the review process, without the express written permission of the authors is strictly forbidden and may result in legal action.

